<?php

/**
 * Implements hook_menu().
 */
function campaignion_manage_menu() {
  $items['campaignion/manage/content'] = array(
    'title' => 'Manage content and actions',
    'page callback' => 'campaignion_manage_content_page',
    'access arguments' => array('administer nodes'),
    'type' => MENU_SUGGESTED_ITEM,
  );
  return $items;
}

/**
 * Implements hook_admin_paths().
 */
function campaignion_manage_admin_paths() {
  return array(
    'campaignion/manage/*',
  );
}

/**
 * Implements hook_theme().
 */
function campaignion_manage_theme() {
  $theme['campaignion_manage_node'] = array(
    'variables' => array(
      'node' => NULL,
      'translation_set' => FALSE,
    ),
    'file' => 'campaignion_manage.theme.php',
  );
  return $theme;
}

function campaignion_manage_action_list($entity_type) {
  $my_actions = array();
  $actions = actions_list();
  foreach($actions as $id => &$action) {
    if ($action['type'] == $entity_type) {
      $my_actions[$id] = &$action;
    }
  }
  return $my_actions;
}

/**
 * Page callback: Manage content and actions page
 */
function campaignion_manage_content_page() {
  $baseQuery = new \Drupal\campaignion_manage\ContentQuery();
  $baseQuery->page(20);
  $result = $baseQuery->execute();

  $listing = new \Drupal\campaignion_manage\ContentListing();

  return array(
    'listing' => $listing->build($result),
    'pager' => array(
      '#theme' => 'pager',
    ),
  );
}
